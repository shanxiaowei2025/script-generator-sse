<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>剧本生成器</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            padding-top: 2rem;
            padding-bottom: 2rem;
            background-color: #f8f9fa;
        }
        .header {
            margin-bottom: 2rem;
            text-align: center;
        }
        .script-output {
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            margin-top: 1rem;
        }
        .loading {
            text-align: center;
            display: none;
            margin-top: 1rem;
        }
        .loading-spinner {
            width: 3rem;
            height: 3rem;
        }
        .character-item {
            margin-bottom: 0.5rem;
        }
        .script-output p, .script-output div {
            font-size: 1rem !important; /* 固定正文字体大小 */
        }
        .script-output h4 {
            font-size: 1.2rem !important; /* 固定标题字体大小 */
        }
        /* 统一剧本内容样式 */
        .script-content {
            font-family: 'Microsoft YaHei', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            text-align: left;
            white-space: normal;
            background-color: white;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        /* 流式内容样式 */
        .episode-content {
            max-height: 400px;
            overflow-y: auto;
            position: relative;
        }
        
        /* 完成标记 */
        .complete-marker {
            color: #28a745;
            font-weight: bold;
        }
        
        /* 流式内容打字效果 */
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        .typing-indicator {
            display: inline-block;
            width: 4px;
            height: 14px;
            background-color: #333;
            margin-left: 2px;
            animation: blink 1s infinite;
        }
        
        /* 集数导航样式 */
        .episode-indicators {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .episode-indicator {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #f0f0f0;
            color: #666;
            cursor: pointer;
            position: relative;
        }
        
        .episode-indicator.active {
            background-color: #0d6efd;
            color: white;
        }
        
        .episode-indicator.completed {
            background-color: #e0f7fa;
            border: 1px solid #4fc3f7;
        }
        
        .episode-indicator .complete-icon {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #28a745;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* 错误处理UI */
        .error-options {
            margin-top: 10px;
            display: flex;
            gap: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AI剧本生成器</h1>
            <p class="lead">基于您的选择，我们将为您生成一个剧本大纲</p>
        </div>

        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h5>剧本设置</h5>
                    </div>
                    <div class="card-body">
                        <form id="scriptForm">
                            <!-- 题材选择 -->
                            <div class="mb-3">
                                <label for="genre" class="form-label">题材选择</label>
                                <select class="form-select" id="genre" name="genre" required>
                                    <option value="" selected disabled>请选择题材</option>
                                    <option value="霸道总裁类">霸道总裁类</option>
                                    <option value="甜宠类">甜宠类</option>
                                    <option value="重生穿越类">重生穿越类</option>
                                    <option value="励志逆袭类">励志逆袭类</option>
                                    <option value="家庭伦理类">家庭伦理类</option>
                                    <option value="悬疑探案类">悬疑探案类</option>
                                    <option value="喜剧类">喜剧类</option>
                                    <option value="古装宫廷类">古装宫廷类</option>
                                </select>
                            </div>

                            <!-- 每集时长 -->
                            <div class="mb-3">
                                <label for="duration" class="form-label">每集时长</label>
                                <select class="form-select" id="duration" name="duration" required>
                                    <option value="" selected disabled>请选择时长</option>
                                    <option value="1-3分钟">1-3分钟</option>
                                    <option value="3-5分钟">3-5分钟</option>
                                </select>
                            </div>

                            <!-- 集数选择 -->
                            <div class="mb-3">
                                <label for="episodes" class="form-label">集数选择</label>
                                <input type="number" class="form-control" id="episodes" name="episodes" min="1" max="100" required placeholder="请输入集数">
                            </div>

                            <!-- 角色设置 -->
                            <div class="mb-3">
                                <label class="form-label">角色设置 (至少选择4个)</label>
                                <div id="charactersList">
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="乐乐 男 6" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">乐乐 男 6</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="默默 女 6" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">默默 女 6</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="贺星野 男 16" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">贺星野 男 16</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="陈小雨 女 16" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">陈小雨 女 16</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="马奇 男 25" id="char1" name="characters">
                                        <label class="form-check-label" for="char1">马奇 男 25</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="苏黎 女 25" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">苏黎 女 25</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="林晓峰 男 30" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">林晓峰 男 30</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="林若宁 女 30" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">林若宁 女 30</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="赵明辉 男 45" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">赵明辉 男 45</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="周雅芳 女 45" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">周雅芳 女 45</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="王德强 男 55" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">王德强 男 55</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="陈淑媛 女 55" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">陈淑媛 女 55</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="黄海生 男 60" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">黄海生 男 60</label>
                                    </div>
                                    <div class="character-item form-check">
                                        <input class="form-check-input" type="checkbox" value="王素琴 女 60" id="char2" name="characters">
                                        <label class="form-check-label" for="char2">王素琴 女 60</label>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">开始生成</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>生成的剧本</h5>
                    </div>
                    <div class="card-body">
                        <div id="status" class="alert alert-info">准备连接服务器...</div>
                        
                        <div class="progress mb-3" id="progressContainer" style="display:none">
                            <div id="progressBar" class="progress-bar" role="progressbar" 
                                 style="width: 0%" aria-valuenow="0" aria-valuemin="0" 
                                 aria-valuemax="100">0%</div>
                        </div>
                        
                        <div id="loading" class="loading">
                            <div class="spinner-border loading-spinner text-primary" role="status">
                                <span class="visually-hidden">加载中...</span>
                            </div>
                            <p class="mt-2">正在生成剧本，请稍候...</p>
                        </div>
                        
                        <!-- 分阶段显示内容 -->
                        <div id="scriptOutput" class="script-output">
                            <!-- 角色表和目录 -->
                            <div id="initialContent" class="mb-4" style="display:none"></div>
                            
                            <!-- 分集导航 -->
                            <div id="episodeNavigation" class="mb-3" style="display:none"></div>
                            
                            <!-- 分集内容容器 -->
                            <div id="episodesContainer"></div>
                            
                            <!-- 默认提示 -->
                            <p class="text-muted text-center" id="defaultMessage">填写并提交表单后，生成的剧本将显示在这里</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/script.js?v=1.0.2"></script>
</body>
</html> 